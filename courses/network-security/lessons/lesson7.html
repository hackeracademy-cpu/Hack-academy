<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Forensics - Hack Academy</title>
    <link rel="stylesheet" href="../../../styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/monokai-sublime.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
</head>
<body>
    <nav class="navbar">
        <div class="logo">
            <i class="fas fa-shield-alt"></i>
            <span>Hack Academy</span>
        </div>
        <ul class="nav-links">
            <li><a href="../../../index.html">Home</a></li>
            <li><a href="../../../index.html#courses">Courses</a></li>
            <li><a href="#" class="login-btn">Login</a></li>
        </ul>
    </nav>

    <div class="lesson-container">
        <div class="lesson-content">
            <h1>Network Forensics</h1>
            
            <section class="lesson-section">
                <h2>Understanding Network Forensics</h2>
                <p>Network forensics involves capturing, recording, and analyzing network traffic and events to discover the source of security attacks or other network problems.</p>
            </section>

            <section class="lesson-section">
                <h2>Key Components</h2>
                <div class="info-box">
                    <h3>Forensic Analysis Tools:</h3>
                    <ul>
                        <li><strong>Packet Capture:</strong> Traffic recording</li>
                        <li><strong>Log Analysis:</strong> Event correlation</li>
                        <li><strong>Flow Analysis:</strong> Traffic patterns</li>
                        <li><strong>Timeline Creation:</strong> Event reconstruction</li>
                    </ul>
                </div>
            </section>

            <section class="lesson-section">
                <h2>Implementation Example</h2>
                <div class="code-example">
                    <pre><code class="language-python">
# Network Forensics Implementation
class NetworkForensics:
    def __init__(self):
        self.packet_store = []
        self.event_logs = []
        self.flow_data = {}
        self.timeline = []
        self.evidence = {}

    def capture_traffic(self, interface, duration):
        """Capture network traffic"""
        capture = self._initialize_capture(interface)
        packets = self._collect_packets(capture, duration)
        self._store_packets(packets)
        return len(packets)

    def analyze_packets(self, time_range=None):
        """Analyze captured packets"""
        packets = self._get_packets(time_range)
        analysis = {
            'protocols': self._analyze_protocols(packets),
            'connections': self._analyze_connections(packets),
            'anomalies': self._detect_anomalies(packets)
        }
        return analysis

    def correlate_events(self, timeframe):
        """Correlate network events"""
        events = self._get_events(timeframe)
        flows = self._get_flows(timeframe)
        
        correlation = self._correlate_data(events, flows)
        self._update_timeline(correlation)
        
        return correlation

    def generate_report(self, case_id):
        """Generate forensic report"""
        return {
            'case_id': case_id,
            'timeline': self._format_timeline(),
            'findings': self._compile_findings(),
            'evidence': self._collect_evidence(),
            'recommendations': self._make_recommendations()
        }

    def _initialize_capture(self, interface):
        """Initialize packet capture"""
        capture_config = {
            'interface': interface,
            'promiscuous': True,
            'snaplen': 65535,
            'timeout': 1000
        }
        return self._setup_capture(capture_config)

    def _collect_packets(self, capture, duration):
        """Collect network packets"""
        start_time = time.time()
        packets = []
        
        while time.time() - start_time < duration:
            packet = capture.next()
            if packet:
                packets.append(self._process_packet(packet))
                
        return packets

    def _analyze_protocols(self, packets):
        """Analyze protocol distribution"""
        protocols = {}
        for packet in packets:
            proto = packet.get_protocol()
            protocols[proto] = protocols.get(proto, 0) + 1
        return protocols

    def _analyze_connections(self, packets):
        """Analyze network connections"""
        connections = {}
        for packet in packets:
            conn_id = self._get_connection_id(packet)
            if conn_id not in connections:
                connections[conn_id] = self._create_connection_record(packet)
            self._update_connection(connections[conn_id], packet)
        return connections

    def _detect_anomalies(self, packets):
        """Detect traffic anomalies"""
        anomalies = []
        baseline = self._calculate_baseline(packets)
        
        for packet in packets:
            if self._is_anomalous(packet, baseline):
                anomalies.append(self._create_anomaly_record(packet))
                
        return anomalies

    def _correlate_data(self, events, flows):
        """Correlate events with flows"""
        correlation = {}
        for event in events:
            matching_flows = self._find_matching_flows(event, flows)
            if matching_flows:
                correlation[event['id']] = {
                    'event': event,
                    'flows': matching_flows,
                    'confidence': self._calculate_confidence(event, matching_flows)
                }
        return correlation

    def _format_timeline(self):
        """Format timeline for reporting"""
        # Implementation details
        pass

    def _compile_findings(self):
        """Compile investigation findings"""
        # Implementation details
        pass

    def _collect_evidence(self):
        """Collect and organize evidence"""
        # Implementation details
        pass

    def _make_recommendations(self):
        """Make security recommendations"""
        # Implementation details
        pass</code></pre>
                </div>
            </section>

            <section class="lesson-section">
                <h2>Best Practices</h2>
                <div class="info-box warning">
                    <h3>Forensic Investigation Guidelines:</h3>
                    <ul>
                        <li>Maintain evidence integrity</li>
                        <li>Document all procedures</li>
                        <li>Establish chain of custody</li>
                        <li>Use write blockers</li>
                        <li>Create forensic copies</li>
                    </ul>
                </div>
            </section>

            <section class="lesson-section">
                <h2>Practice Quiz</h2>
                <div class="quiz" id="lesson7-quiz">
                    <div class="question" data-correct="a">
                        <p>What is the primary purpose of maintaining chain of custody?</p>
                        <div class="options">
                            <label>
                                <input type="radio" name="q1" value="a">
                                Track evidence handling
                            </label>
                            <label>
                                <input type="radio" name="q1" value="b">
                                Speed up analysis
                            </label>
                            <label>
                                <input type="radio" name="q1" value="c">
                                Reduce storage space
                            </label>
                            <label>
                                <input type="radio" name="q1" value="d">
                                Improve network speed
                            </label>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question" data-correct="b">
                        <p>Why are write blockers used in forensic analysis?</p>
                        <div class="options">
                            <label>
                                <input type="radio" name="q2" value="a">
                                Improve read speed
                            </label>
                            <label>
                                <input type="radio" name="q2" value="b">
                                Prevent evidence modification
                            </label>
                            <label>
                                <input type="radio" name="q2" value="c">
                                Compress data
                            </label>
                            <label>
                                <input type="radio" name="q2" value="d">
                                Encrypt evidence
                            </label>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <button class="submit-quiz">Submit Answers</button>
                </div>
            </section>

            <div class="lesson-navigation">
                <button class="nav-btn prev" onclick="window.location.href='lesson6.html'">Previous Lesson</button>
                <button class="nav-btn next" onclick="window.location.href='lesson8.html'">Next Lesson</button>
            </div>
        </div>
    </div>

    <script src="../script.js"></script>
</body>
</html> 