<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IDS/IPS Systems - Hack Academy</title>
    <link rel="stylesheet" href="../../../styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/monokai-sublime.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
</head>
<body>
    <nav class="navbar">
        <div class="logo">
            <i class="fas fa-shield-alt"></i>
            <span>Hack Academy</span>
        </div>
        <ul class="nav-links">
            <li><a href="../../../index.html">Home</a></li>
            <li><a href="../../../index.html#courses">Courses</a></li>
            <li><a href="#" class="login-btn">Login</a></li>
        </ul>
    </nav>

    <div class="lesson-container">
        <div class="lesson-content">
            <h1>Intrusion Detection and Prevention Systems</h1>
            
            <section class="lesson-section">
                <h2>Understanding IDS/IPS</h2>
                <p>IDS/IPS systems are essential network security tools that monitor network traffic for suspicious activity and take automated actions to prevent threats.</p>
            </section>

            <section class="lesson-section">
                <h2>Types of Systems</h2>
                <div class="info-box">
                    <h3>IDS/IPS Categories:</h3>
                    <ul>
                        <li><strong>Network-based (NIDS/NIPS):</strong> Monitor network traffic</li>
                        <li><strong>Host-based (HIDS/HIPS):</strong> Monitor system activities</li>
                        <li><strong>Signature-based:</strong> Known attack patterns</li>
                        <li><strong>Anomaly-based:</strong> Behavior analysis</li>
                    </ul>
                </div>
            </section>

            <section class="lesson-section">
                <h2>Implementation Example</h2>
                <div class="code-example">
                    <pre><code class="language-python">
# IDS/IPS Implementation Example
class IntrusionDetectionSystem:
    def __init__(self):
        self.signatures = {}
        self.baseline = {}
        self.alerts = []
        self.prevention_actions = {
            'block_ip': self._block_ip,
            'terminate_connection': self._terminate_connection,
            'log_alert': self._log_alert
        }

    def load_signatures(self, signature_file):
        """Load attack signatures from file"""
        try:
            with open(signature_file, 'r') as f:
                self.signatures = json.load(f)
        except Exception as e:
            self._log_error(f"Failed to load signatures: {e}")

    def analyze_traffic(self, packet):
        """Analyze network traffic for threats"""
        if self._match_signature(packet):
            self._handle_threat(packet)
            return False
            
        if self._detect_anomaly(packet):
            self._investigate_anomaly(packet)
            return False
            
        return True

    def _match_signature(self, packet):
        """Check packet against known signatures"""
        for sig_name, signature in self.signatures.items():
            if self._pattern_match(packet, signature['pattern']):
                self._log_alert(f"Signature match: {sig_name}")
                return True
        return False

    def _detect_anomaly(self, packet):
        """Detect anomalous behavior"""
        score = self._calculate_anomaly_score(packet)
        threshold = self.baseline.get('threshold', 0.8)
        return score > threshold

    def _calculate_anomaly_score(self, packet):
        """Calculate anomaly score based on behavior"""
        features = self._extract_features(packet)
        return self._compare_to_baseline(features)

    def _handle_threat(self, packet):
        """Handle detected threats"""
        threat_level = self._assess_threat_level(packet)
        actions = self._determine_actions(threat_level)
        
        for action in actions:
            if action in self.prevention_actions:
                self.prevention_actions[action](packet)

    def _block_ip(self, packet):
        """Block malicious IP address"""
        # Implementation details
        pass

    def _terminate_connection(self, packet):
        """Terminate suspicious connection"""
        # Implementation details
        pass

    def _log_alert(self, message):
        """Log security alert"""
        timestamp = datetime.now().isoformat()
        self.alerts.append({
            'timestamp': timestamp,
            'message': message
        })

    def _extract_features(self, packet):
        """Extract behavioral features from packet"""
        # Implementation details
        pass

    def _compare_to_baseline(self, features):
        """Compare features to baseline behavior"""
        # Implementation details
        pass

    def _assess_threat_level(self, packet):
        """Assess threat level of detected issue"""
        # Implementation details
        pass

    def _determine_actions(self, threat_level):
        """Determine appropriate response actions"""
        # Implementation details
        pass</code></pre>
                </div>
            </section>

            <section class="lesson-section">
                <h2>Best Practices</h2>
                <div class="info-box warning">
                    <h3>IDS/IPS Implementation Guidelines:</h3>
                    <ul>
                        <li>Regular signature updates</li>
                        <li>Proper placement in network</li>
                        <li>Baseline behavior profiling</li>
                        <li>Alert tuning and management</li>
                        <li>Response automation configuration</li>
                    </ul>
                </div>
            </section>

            <section class="lesson-section">
                <h2>Practice Quiz</h2>
                <div class="quiz" id="lesson4-quiz">
                    <div class="question" data-correct="b">
                        <p>What is the main difference between IDS and IPS?</p>
                        <div class="options">
                            <label>
                                <input type="radio" name="q1" value="a">
                                Detection accuracy
                            </label>
                            <label>
                                <input type="radio" name="q1" value="b">
                                Active response capability
                            </label>
                            <label>
                                <input type="radio" name="q1" value="c">
                                Installation location
                            </label>
                            <label>
                                <input type="radio" name="q1" value="d">
                                Monitoring speed
                            </label>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <div class="question" data-correct="a">
                        <p>Which detection method is most effective against zero-day attacks?</p>
                        <div class="options">
                            <label>
                                <input type="radio" name="q2" value="a">
                                Anomaly-based detection
                            </label>
                            <label>
                                <input type="radio" name="q2" value="b">
                                Signature-based detection
                            </label>
                            <label>
                                <input type="radio" name="q2" value="c">
                                Pattern matching
                            </label>
                            <label>
                                <input type="radio" name="q2" value="d">
                                Rule-based detection
                            </label>
                        </div>
                        <div class="feedback"></div>
                    </div>

                    <button class="submit-quiz">Submit Answers</button>
                </div>
            </section>

            <div class="lesson-navigation">
                <button class="nav-btn prev" onclick="window.location.href='lesson3.html'">Previous Lesson</button>
                <button class="nav-btn next" onclick="window.location.href='lesson5.html'">Next Lesson</button>
            </div>
        </div>
    </div>

    <script src="../script.js"></script>
</body>
</html> 